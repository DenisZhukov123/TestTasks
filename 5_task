using System;
namespace FindSeq
{
	public class Program
    {
		public static string reversesymbol(char a) //функция возвращает закрывающую скобку
		{
			if (a=='(') // для скобки '('
				return ")";
			else if (a=='{') // для скобки '{'
				return "}";
			else return "]"; // для скобки ']'
		}
		public static bool checkstring(string str) //функция проверки строки на правильную скобочную последовательность
		{
			string str1="";// временная строка для хранения закрывающий скобок
			for (int i = 0; i < str.Length; i++)//проходим по всем символам введенной строки
         	{
				if (str[i] == '(' || str[i] == '{' || str[i]=='[') //если встретилась открывающая скобка, заносим во временную строку эквивалентную ей закрывающую
             	{
			   		 str1 = str1 + reversesymbol(str[i]);					
            	}
			 	else if (str1.Length==0)
				/* проверяем длину временной строки если длина строки равна 0, а нам встретилась закрывающая
				скобка значит строка либо начинается на закрывающую скобку, что неправильно, либо в строке встречается закрывающая скобка без открывающей*/
				{
					 return false;
				}			 	
				else if(str[i]==str1[str1.Length-1])
				/* проверяем соответвствие закрывающей скобки в изучаемой строке и скобки во временной строке, если скобки совпадают, 
				значит в последовательности закрыта правильная скобка и можно эту скобку из временной строки удалить, в противном случае возврат false*/
				{
			     	 str1=str1.Remove(str1.Length-1);
				}
				else
				{
					return false;
				}
			}
			if(str1.Length!=0)
			{
			 /* если все тесты пройдены и не было прерывания функции, 
		     но длина временной строки не равна 0, значит скобочная последовательность не правильная, т.к. число символов в последовательности нечетное 
		     */
				return false; // если все тесты пройдены и не было прерывания функции, значит скобочная псоледовательность правильная 
			}
			return true; // / если все тесты пройдены и не было прерывания функции, значит скобочная псоледовательность правильная 
		}
		public static void Main()
		{
			Console.WriteLine("Введите строку: ");
			string str = Console.ReadLine(); // вводим строку
			if (checkstring(str)==true)
				Console.Write("Скобочная последовательность правильная");
			else
				Console.Write("Скобочная последовательность неправильная");
			Console.ReadLine();
		}
	}
}
